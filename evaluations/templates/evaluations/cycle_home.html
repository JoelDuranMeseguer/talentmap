{% extends "base.html" %}
{% block title %}Panel · {{ cycle.name }} · TalentMap{% endblock %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-start mb-4">
    <div>
      <h3 class="mb-1">Panel</h3>
      <div class="text-muted">{{ cycle.name }}</div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-secondary" href="{% url 'logout' %}">Salir</a>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <div class="card p-4">
        <h5 class="mb-2">Mi evaluación</h5>
        {% if my_score %}
          <div class="text-muted">
            Cualitativo: <strong>{{ my_score.qualitative_score }}</strong> ·
            Cuantitativo: <strong>{{ my_score.quantitative_score }}</strong><br/>
            9-Box: <strong>{{ my_score.box_label }}</strong>
          </div>
        {% else %}
          <div class="text-muted">Aún no hay score calculado para ti en este ciclo.</div>
        {% endif %}
        {% if can_edit_me %}
          <div class="d-flex gap-2 mt-3">
            <a class="btn btn-primary" href="{% url 'edit_qualitative' cycle.id me.id %}">Editar cualitativo</a>
            <a class="btn btn-outline-primary" href="{% url 'competency_picker' cycle.id me.id %}">Editar cuantitativo</a>
          </div>
        {% else %}
          <p class="text-muted small mt-2 mb-0">Solo tu superior o administrador pueden editar tu evaluación.</p>
        {% endif %}
      </div>
    </div>

    <div class="col-md-6">
      <div class="card p-4">
        <h5 class="mb-2">Equipo / HR</h5>
        {% if is_manager or is_hr %}
          <div class="text-muted">Gestiona evaluaciones y consulta el mapa.</div>
          <div class="d-flex gap-2 mt-3 flex-wrap">
            <a class="btn btn-primary" href="{% url 'team_overview' cycle.id %}">Mi equipo</a>
            <a class="btn btn-outline-primary" href="{% url 'nine_box' cycle.id %}">Mapa 9-Box</a>
          </div>
        {% else %}
          <div class="text-muted">No tienes permisos de manager/HR.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
