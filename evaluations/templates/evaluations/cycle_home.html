{% extends "base.html" %}
{% block title %}Panel · {{ cycle.name }} · TalentMap{% endblock %}

{% block content %}
<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h3 class="mb-1">Panel</h3>
      <div class="text-muted">{{ cycle.name }}</div>
    </div>
    <a class="btn btn-outline-secondary" href="{% url 'logout' %}">Salir</a>
  </div>

  <div class="row g-3">
    <div class="col-lg-6">
      <div class="card p-4">
        <h5 class="mb-3">Mi evaluación</h5>

        {% if my_score %}
          <div class="d-flex flex-wrap gap-2 align-items-center">
            <span class="badge text-bg-primary">Cualitativo: {{ my_score.qualitative_score }}</span>
            <span class="badge text-bg-secondary">Cuantitativo: {{ my_score.quantitative_score }}</span>
            <span class="badge text-bg-dark">9-Box: {{ my_score.box_label }}</span>
          </div>
        {% else %}
          <p class="text-muted mb-0">Aún no hay score calculado para ti en este ciclo.</p>
        {% endif %}

        {% if can_edit_me %}
          <hr class="my-4">
          <div class="d-flex flex-wrap gap-2">
            <a class="btn btn-outline-primary" href="{% url 'edit_quantitative' employee_id=me.id %}">
              Editar cuantitativo (metas)
            </a>
            <a class="btn btn-outline-primary" href="{% url 'competency_picker' employee_id=me.id %}">
              Editar cualitativo (competencias)
            </a>
          </div>
        {% else %}
          <div class="mt-3 text-muted small">Solo tu superior o administración pueden editar tu evaluación.</div>
        {% endif %}
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card p-4">
        <h5 class="mb-3">Equipo / HR</h5>

        {% if is_manager or is_hr %}
          <p class="text-muted">Gestiona evaluaciones del equipo.</p>
          <div class="d-flex flex-wrap gap-2">
            <a class="btn btn-primary" href="{% url 'team_overview' %}">Mi equipo</a>
            {% if is_hr %}
              <a class="btn btn-outline-primary" href="{% url 'nine_box' %}">Mapa 9-Box</a>
            {% endif %}
          </div>
        {% else %}
          <p class="text-muted mb-0">No tienes permisos de manager/HR.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
